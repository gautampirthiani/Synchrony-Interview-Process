{"ast":null,"code":"var AWS = require('../core');\nvar inherit = AWS.util.inherit;\n\n/**\n * @api private\n */\nAWS.Signers.S3 = inherit(AWS.Signers.RequestSigner, {\n  /**\n   * When building the stringToSign, these sub resource params should be\n   * part of the canonical resource string with their NON-decoded values\n   */\n  subResources: {\n    'acl': 1,\n    'accelerate': 1,\n    'analytics': 1,\n    'cors': 1,\n    'lifecycle': 1,\n    'delete': 1,\n    'inventory': 1,\n    'location': 1,\n    'logging': 1,\n    'metrics': 1,\n    'notification': 1,\n    'partNumber': 1,\n    'policy': 1,\n    'requestPayment': 1,\n    'replication': 1,\n    'restore': 1,\n    'tagging': 1,\n    'torrent': 1,\n    'uploadId': 1,\n    'uploads': 1,\n    'versionId': 1,\n    'versioning': 1,\n    'versions': 1,\n    'website': 1\n  },\n  // when building the stringToSign, these querystring params should be\n  // part of the canonical resource string with their NON-encoded values\n  responseHeaders: {\n    'response-content-type': 1,\n    'response-content-language': 1,\n    'response-expires': 1,\n    'response-cache-control': 1,\n    'response-content-disposition': 1,\n    'response-content-encoding': 1\n  },\n  addAuthorization: function addAuthorization(credentials, date) {\n    if (!this.request.headers['presigned-expires']) {\n      this.request.headers['X-Amz-Date'] = AWS.util.date.rfc822(date);\n    }\n    if (credentials.sessionToken) {\n      // presigned URLs require this header to be lowercased\n      this.request.headers['x-amz-security-token'] = credentials.sessionToken;\n    }\n    var signature = this.sign(credentials.secretAccessKey, this.stringToSign());\n    var auth = 'AWS ' + credentials.accessKeyId + ':' + signature;\n    this.request.headers['Authorization'] = auth;\n  },\n  stringToSign: function stringToSign() {\n    var r = this.request;\n    var parts = [];\n    parts.push(r.method);\n    parts.push(r.headers['Content-MD5'] || '');\n    parts.push(r.headers['Content-Type'] || '');\n\n    // This is the \"Date\" header, but we use X-Amz-Date.\n    // The S3 signing mechanism requires us to pass an empty\n    // string for this Date header regardless.\n    parts.push(r.headers['presigned-expires'] || '');\n    var headers = this.canonicalizedAmzHeaders();\n    if (headers) parts.push(headers);\n    parts.push(this.canonicalizedResource());\n    return parts.join('\\n');\n  },\n  canonicalizedAmzHeaders: function canonicalizedAmzHeaders() {\n    var amzHeaders = [];\n    AWS.util.each(this.request.headers, function (name) {\n      if (name.match(/^x-amz-/i)) amzHeaders.push(name);\n    });\n    amzHeaders.sort(function (a, b) {\n      return a.toLowerCase() < b.toLowerCase() ? -1 : 1;\n    });\n    var parts = [];\n    AWS.util.arrayEach.call(this, amzHeaders, function (name) {\n      parts.push(name.toLowerCase() + ':' + String(this.request.headers[name]));\n    });\n    return parts.join('\\n');\n  },\n  canonicalizedResource: function canonicalizedResource() {\n    var r = this.request;\n    var parts = r.path.split('?');\n    var path = parts[0];\n    var querystring = parts[1];\n    var resource = '';\n    if (r.virtualHostedBucket) resource += '/' + r.virtualHostedBucket;\n    resource += path;\n    if (querystring) {\n      // collect a list of sub resources and query params that need to be signed\n      var resources = [];\n      AWS.util.arrayEach.call(this, querystring.split('&'), function (param) {\n        var name = param.split('=')[0];\n        var value = param.split('=')[1];\n        if (this.subResources[name] || this.responseHeaders[name]) {\n          var subresource = {\n            name: name\n          };\n          if (value !== undefined) {\n            if (this.subResources[name]) {\n              subresource.value = value;\n            } else {\n              subresource.value = decodeURIComponent(value);\n            }\n          }\n          resources.push(subresource);\n        }\n      });\n      resources.sort(function (a, b) {\n        return a.name < b.name ? -1 : 1;\n      });\n      if (resources.length) {\n        querystring = [];\n        AWS.util.arrayEach(resources, function (res) {\n          if (res.value === undefined) {\n            querystring.push(res.name);\n          } else {\n            querystring.push(res.name + '=' + res.value);\n          }\n        });\n        resource += '?' + querystring.join('&');\n      }\n    }\n    return resource;\n  },\n  sign: function sign(secret, string) {\n    return AWS.util.crypto.hmac(secret, string, 'base64', 'sha1');\n  }\n});\n\n/**\n * @api private\n */\nmodule.exports = AWS.Signers.S3;","map":{"version":3,"names":["AWS","require","inherit","util","Signers","S3","RequestSigner","subResources","responseHeaders","addAuthorization","credentials","date","request","headers","rfc822","sessionToken","signature","sign","secretAccessKey","stringToSign","auth","accessKeyId","r","parts","push","method","canonicalizedAmzHeaders","canonicalizedResource","join","amzHeaders","each","name","match","sort","a","b","toLowerCase","arrayEach","call","String","path","split","querystring","resource","virtualHostedBucket","resources","param","value","subresource","undefined","decodeURIComponent","length","res","secret","string","crypto","hmac","module","exports"],"sources":["/Users/damianmiskow/Desktop/Projects/Synchrony-Interview-Process/node_modules/aws-sdk/lib/signers/s3.js"],"sourcesContent":["var AWS = require('../core');\nvar inherit = AWS.util.inherit;\n\n/**\n * @api private\n */\nAWS.Signers.S3 = inherit(AWS.Signers.RequestSigner, {\n  /**\n   * When building the stringToSign, these sub resource params should be\n   * part of the canonical resource string with their NON-decoded values\n   */\n  subResources: {\n    'acl': 1,\n    'accelerate': 1,\n    'analytics': 1,\n    'cors': 1,\n    'lifecycle': 1,\n    'delete': 1,\n    'inventory': 1,\n    'location': 1,\n    'logging': 1,\n    'metrics': 1,\n    'notification': 1,\n    'partNumber': 1,\n    'policy': 1,\n    'requestPayment': 1,\n    'replication': 1,\n    'restore': 1,\n    'tagging': 1,\n    'torrent': 1,\n    'uploadId': 1,\n    'uploads': 1,\n    'versionId': 1,\n    'versioning': 1,\n    'versions': 1,\n    'website': 1\n  },\n\n  // when building the stringToSign, these querystring params should be\n  // part of the canonical resource string with their NON-encoded values\n  responseHeaders: {\n    'response-content-type': 1,\n    'response-content-language': 1,\n    'response-expires': 1,\n    'response-cache-control': 1,\n    'response-content-disposition': 1,\n    'response-content-encoding': 1\n  },\n\n  addAuthorization: function addAuthorization(credentials, date) {\n    if (!this.request.headers['presigned-expires']) {\n      this.request.headers['X-Amz-Date'] = AWS.util.date.rfc822(date);\n    }\n\n    if (credentials.sessionToken) {\n      // presigned URLs require this header to be lowercased\n      this.request.headers['x-amz-security-token'] = credentials.sessionToken;\n    }\n\n    var signature = this.sign(credentials.secretAccessKey, this.stringToSign());\n    var auth = 'AWS ' + credentials.accessKeyId + ':' + signature;\n\n    this.request.headers['Authorization'] = auth;\n  },\n\n  stringToSign: function stringToSign() {\n    var r = this.request;\n\n    var parts = [];\n    parts.push(r.method);\n    parts.push(r.headers['Content-MD5'] || '');\n    parts.push(r.headers['Content-Type'] || '');\n\n    // This is the \"Date\" header, but we use X-Amz-Date.\n    // The S3 signing mechanism requires us to pass an empty\n    // string for this Date header regardless.\n    parts.push(r.headers['presigned-expires'] || '');\n\n    var headers = this.canonicalizedAmzHeaders();\n    if (headers) parts.push(headers);\n    parts.push(this.canonicalizedResource());\n\n    return parts.join('\\n');\n\n  },\n\n  canonicalizedAmzHeaders: function canonicalizedAmzHeaders() {\n\n    var amzHeaders = [];\n\n    AWS.util.each(this.request.headers, function (name) {\n      if (name.match(/^x-amz-/i))\n        amzHeaders.push(name);\n    });\n\n    amzHeaders.sort(function (a, b) {\n      return a.toLowerCase() < b.toLowerCase() ? -1 : 1;\n    });\n\n    var parts = [];\n    AWS.util.arrayEach.call(this, amzHeaders, function (name) {\n      parts.push(name.toLowerCase() + ':' + String(this.request.headers[name]));\n    });\n\n    return parts.join('\\n');\n\n  },\n\n  canonicalizedResource: function canonicalizedResource() {\n\n    var r = this.request;\n\n    var parts = r.path.split('?');\n    var path = parts[0];\n    var querystring = parts[1];\n\n    var resource = '';\n\n    if (r.virtualHostedBucket)\n      resource += '/' + r.virtualHostedBucket;\n\n    resource += path;\n\n    if (querystring) {\n\n      // collect a list of sub resources and query params that need to be signed\n      var resources = [];\n\n      AWS.util.arrayEach.call(this, querystring.split('&'), function (param) {\n        var name = param.split('=')[0];\n        var value = param.split('=')[1];\n        if (this.subResources[name] || this.responseHeaders[name]) {\n          var subresource = { name: name };\n          if (value !== undefined) {\n            if (this.subResources[name]) {\n              subresource.value = value;\n            } else {\n              subresource.value = decodeURIComponent(value);\n            }\n          }\n          resources.push(subresource);\n        }\n      });\n\n      resources.sort(function (a, b) { return a.name < b.name ? -1 : 1; });\n\n      if (resources.length) {\n\n        querystring = [];\n        AWS.util.arrayEach(resources, function (res) {\n          if (res.value === undefined) {\n            querystring.push(res.name);\n          } else {\n            querystring.push(res.name + '=' + res.value);\n          }\n        });\n\n        resource += '?' + querystring.join('&');\n      }\n\n    }\n\n    return resource;\n\n  },\n\n  sign: function sign(secret, string) {\n    return AWS.util.crypto.hmac(secret, string, 'base64', 'sha1');\n  }\n});\n\n/**\n * @api private\n */\nmodule.exports = AWS.Signers.S3;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}